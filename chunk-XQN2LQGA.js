import{a as V,c as q}from"./chunk-HYXUQW37.js";import"./chunk-A3PXOTSA.js";import{a as T}from"./chunk-AT3UWOFJ.js";import{a as L}from"./chunk-6KHY3KLJ.js";import{a as R}from"./chunk-44IC75YN.js";import{b as W,e as k,f as x,g as U,h as O,i as B,m as F}from"./chunk-LDELUNJN.js";import{$ as n,A as y,B as P,E as m,Ga as w,Ha as D,K as l,Ma as A,N as S,Oa as N,Sa as I,U as v,V as _,Z as f,_ as r,aa as C,ea as M,fa as p,ga as E,ma as d,pa as h,qa as u,ra as g,ua as b,y as c}from"./chunk-SAK6RFBY.js";import"./chunk-DAQOROHW.js";var Q=s=>({"background-image":s});function G(s,i){if(s&1&&C(0,"div",5),s&2){let e=E();f("ngStyle",b(1,Q,"url("+e.cover()+")"))}}function Y(s,i){if(s&1){let e=M();r(0,"div",6)(1,"button",14),p("click",function(){y(e);let a=E();return P(a.deletePost())}),d(2,"Remove Post"),n()()}}var j=class s{route=c(A);router=c(N);postService=c(T);userService=c(I);notificationService=c(R);title="";description="";content="";cover=m("");hasUnsavedChanges=!0;idPostEdit=m("null");idAuthorEdit=m("null");ngOnInit(){let i=this.route.snapshot.paramMap.get("idAuthorEdit"),e=this.route.snapshot.paramMap.get("idPostEdit");console.log(i,e,typeof i),i!="null"&&e!="null"&&(console.log("post to edit"),this.idAuthorEdit.set(i),this.idPostEdit.set(e),this.postService.getPostById(this.idPostEdit()).subscribe(t=>{t&&(this.title=t.title,this.content=t.content,this.description=t.description,this.cover.set(t.cover))}))}ngOnDestroy(){this.clearPost(),this.idAuthorEdit.set(""),this.idPostEdit.set("")}setCover(i){this.cover.set(i)}handlePost(){console.log(this.idAuthorEdit,this.idPostEdit,typeof this.idAuthorEdit),this.idAuthorEdit()!=="null"&&this.idPostEdit()!=="null"?this.editPost():this.savePost()}savePost(){if(!this.title||!this.description||!this.content||!this.cover()){this.notificationService.toast("Fields is missing on your post");return}let i=this.userService.getUserOnSession(),e={id:Date.now().toString(),title:this.title,description:this.description,content:this.content,authorId:i.id,cover:this.cover()};this.postService.savePost(e),this.clearPost(),this.hasUnsavedChanges=!1,this.router.navigate(["/home"])}editPost(){let i={authorId:this.idAuthorEdit(),content:this.content,description:this.description,id:this.idPostEdit(),title:this.title,cover:this.cover()},e=this.postService.updatePostById(this.idPostEdit(),i);if(console.log("is up ",e),e){this.notificationService.toast("Post updated succesfully"),this.clearPost(),this.router.navigate(["/home"]);return}this.notificationService.toast("Post not updated. Try again")}clearPost(){this.content="",this.title="",this.description="",this.cover.set("")}canDeactivate(){return!this.hasUnsavedChanges||confirm("Do you want leave this page?")}deletePost(){this.hasUnsavedChanges=!1,this.postService.deletePostById(this.idPostEdit()),this.router.navigate(["/home"])}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=S({type:s,selectors:[["app-editor"]],decls:26,vars:6,consts:[[1,"editor"],[1,"editor__title"],[1,"editor__description"],[1,"editor__cover"],[3,"selectedImageEmitter","typeMedia"],[1,"editor__media",3,"ngStyle"],[1,"editor__delete"],[1,"editor__form"],[1,"form__group"],["type","text","placeholder","Title","name","title",3,"ngModelChange","ngModel"],["rows","3","type","text","placeholder","Description","name","description",3,"ngModelChange","ngModel"],[1,"editor__quill"],["name","content","format","json","placeholder","Your ideas here...",3,"ngModelChange","ngModel"],[1,"editor__actions"],[1,"btn","btn--primary",3,"click"],[1,"material-icons"],[1,"btn","btn--secondary",3,"click"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h1",1),d(2,"Write your post"),n(),r(3,"p",2),d(4," Use the editor below to express your ideas, feelings, and inspirations to your followers. Select text to add styles with our editor. "),n(),r(5,"div",3)(6,"app-avatar",4),p("selectedImageEmitter",function(o){return t.setCover(o)}),n(),v(7,G,1,3,"div",5),v(8,Y,3,0,"div",6),n(),r(9,"div",7)(10,"form")(11,"div",8)(12,"input",9),g("ngModelChange",function(o){return u(t.title,o)||(t.title=o),o}),n()(),r(13,"div",8)(14,"textarea",10),g("ngModelChange",function(o){return u(t.description,o)||(t.description=o),o}),n()()()(),r(15,"div",11)(16,"quill-editor",12),g("ngModelChange",function(o){return u(t.content,o)||(t.content=o),o}),n()(),r(17,"div",13)(18,"button",14),p("click",function(){return t.handlePost()}),r(19,"span",15),d(20,"save"),n(),d(21," Save "),n(),r(22,"button",16),p("click",function(){return t.clearPost()}),r(23,"span",15),d(24,"delete"),n(),d(25," Clear "),n()()()),e&2&&(l(6),f("typeMedia","cover"),l(),_(t.cover()?7:-1),l(),_(t.idPostEdit()?8:-1),l(4),h("ngModel",t.title),l(2),h("ngModel",t.description),l(2),h("ngModel",t.content))},dependencies:[D,w,q,V,F,B,W,k,x,O,U,L],encapsulation:2})};export{j as Editor};
